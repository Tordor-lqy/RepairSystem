import{_ as ne}from"./_plugin-vue_export-helper-x3n3nnut.js";import{a as de}from"./VCard-JZ6WHMNS.js";import{e as re,f as G}from"./VSelect-vc-x1x7s.js";import{V as ue}from"./VDialog-77CPTFay.js";import{bm as q,e as m,j as b,o as Z,a as ce,w as F,t as v,d as t,a8 as ee,b as n,c as xe,a1 as we,u as _,y as _e,z as ve,bK as Ve,bM as ye,bN as be,k as O,s as $e,by as ke,aP as Ce,aL as Ie,bP as Fe,cs as Pe,aF as Q,F as W,bD as se,b1 as Se,bu as De,aG as X,ct as Me,cb as Re,bY as Be,aE as Ue,i as R,bJ as Ne}from"./index-PSqsjCSN.js";import{b as ze,h as Te,g as He}from"./locationapi-0BEEkayc.js";import{r as B}from"./request-gdlVq-Xd.js";import{V as Ae}from"./VCheckbox-43WpQWPy.js";import{m as Ee,a as Ge,u as Oe,b as ie,f as qe,c as Le,d as je}from"./VTextField-psUYnqz0.js";import{f as Je}from"./forwardRefs-y8pOSn8h.js";import{I as Ke}from"./VImg-iF59fwnb.js";const va=(e,d,g,f,r,l,u)=>B.get(`/api/admin/orders?
num=${e}&per=${d}
&one_location_id=${g}
&two_location_id=${f}
&final_location_id=${r}
&damage_type_id=${l}
&user_id=${u}`),me=e=>B.get(`/api/admin/user/info?user_id=${e}`),ma=e=>B.delete(`/api/admin/del/order?order_id=${e}`),Ye=()=>B.get("/api/admin/damage"),Qe=e=>B.post("/api/admin/set/order",e),p=e=>(_e("data-v-32c537fa"),e=e(),ve(),e),We={class:"order_top"},Xe={class:"title text-center my-6"},Ze={class:"text-h5"},et={class:"title"},tt=p(()=>t("div",{class:"t"},[t("hr"),t("span",{class:"px-3"},"故障说明"),t("hr")],-1)),at={class:"text-area"},ot={class:"title"},lt=p(()=>t("div",{class:"t"},[t("hr"),t("span",{class:"px-3"},"故障位置"),t("hr")],-1)),st={class:"text-area"},it={class:"title"},nt=p(()=>t("div",{class:"t"},[t("hr"),t("span",{class:"px-3"},"其他信息"),t("hr")],-1)),dt={class:"text-area"},rt={class:"info"},ut=p(()=>t("div",{class:"l"},"状态",-1)),ct={class:"r"},_t={key:0,class:"info"},vt=p(()=>t("div",{class:"l"},"修复时间",-1)),mt={class:"r"},ft={class:"info"},ht=p(()=>t("div",{class:"l"},"报修时间",-1)),pt={class:"r"},gt={class:"info"},xt=p(()=>t("div",{class:"l"},"编号",-1)),wt={class:"r"},Vt={class:"info"},yt=p(()=>t("div",{class:"l"},"是否公开",-1)),bt={class:"r"},$t={class:"info"},kt=p(()=>t("div",{class:"l"},"报修用户",-1)),Ct={class:"r"},It={class:"info"},Ft=p(()=>t("div",{class:"l"},"报修用户学号",-1)),Pt={class:"r"},St={class:"info"},Dt=p(()=>t("div",{class:"l"},"报修用户部门",-1)),Mt={class:"r"},Rt={class:"info"},Bt=p(()=>t("div",{class:"l"},"报修用户手机号",-1)),Ut={class:"r"},Nt={__name:"OrderDialog",props:{order:{},orderModifiers:{},show:{},showModifiers:{}},emits:["update:order","update:show"],setup(e){const d=q(e,"order"),g=q(e,"show"),f=m({}),r=async()=>{const l=await me(d.value.user_id);f.value=l.data.data};return b(()=>d.value.user_id,()=>{r()}),r(),(l,u)=>(Z(),ce(ue,{modelValue:g.value,"onUpdate:modelValue":u[0]||(u[0]=P=>g.value=P),transition:"dialog-bottom-transition",width:"auto"},{default:F(()=>[n(de,{width:"90vw",height:"80vh","max-width":"800px","prepend-icon":"mdi-reorder-horizontal",title:"详细信息"},{default:F(()=>[t("div",We,[t("div",Xe,[t("div",Ze,v(d.value.damage_type_name),1)]),t("div",et,[tt,t("div",at,v(d.value.damage_details),1)]),t("div",ot,[lt,t("div",st,v(d.value.one_location_name+"-"+d.value.two_location_name+"-"+d.value.final_location_name),1)]),t("div",it,[nt,t("div",dt,[t("div",rt,[ut,t("div",ct,[n(re,{color:d.value.order_is_repaired==1?"success":"error"},{default:F(()=>[ee(v(d.value.order_is_repaired==0?"未修复":"已修复"),1)]),_:1},8,["color"])])]),d.value.order_is_repaired==1?(Z(),xe("div",_t,[vt,t("div",mt,v(d.value.order_completed_time),1)])):we("",!0),t("div",ft,[ht,t("div",pt,v(d.value.order_update_time),1)]),t("div",gt,[xt,t("div",wt,v(d.value.order_id),1)]),t("div",Vt,[yt,t("div",bt,v(d.value.order_is_public==1?"是":"否"),1)]),t("div",$t,[kt,t("div",Ct,v(`${_(f).user_name} (ID:${d.value.user_id})`),1)]),t("div",It,[Ft,t("div",Pt,v(_(f).user_henau_number),1)]),t("div",St,[Dt,t("div",Mt,v(_(f).user_section),1)]),t("div",Rt,[Bt,t("div",Ut,v(_(f).user_phone),1)])])])])]),_:1})]),_:1},8,["modelValue"]))}},fa=ne(Nt,[["__scopeId","data-v-32c537fa"]]),zt=Ve({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...Ee(),...Ge()},"VTextarea"),Tt=ye()({name:"VTextarea",directives:{Intersect:Ke},inheritAttrs:!1,props:zt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,d){let{attrs:g,emit:f,slots:r}=d;const l=be(e,"modelValue"),{isFocused:u,focus:P,blur:U}=Oe(e),N=O(()=>typeof e.counterValue=="function"?e.counterValue(l.value):(l.value||"").toString().length),w=O(()=>{if(g.maxlength)return g.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function V(s,x){var h,y;!e.autofocus||!s||(y=(h=x[0].target)==null?void 0:h.focus)==null||y.call(h)}const c=m(),$=m(),z=$e(""),S=m(),L=O(()=>e.persistentPlaceholder||u.value||e.active);function M(){var s;S.value!==document.activeElement&&((s=S.value)==null||s.focus()),u.value||P()}function j(s){M(),f("click:control",s)}function T(s){f("mousedown:control",s)}function H(s){s.stopPropagation(),M(),X(()=>{l.value="",Me(e["onClick:clear"],s)})}function J(s){var h;const x=s.target;if(l.value=x.value,(h=e.modelModifiers)!=null&&h.trim){const y=[x.selectionStart,x.selectionEnd];X(()=>{x.selectionStart=y[0],x.selectionEnd=y[1]})}}const k=m(),a=m(+e.rows),o=O(()=>["plain","underlined"].includes(e.variant));ke(()=>{e.autoGrow||(a.value=+e.rows)});function i(){e.autoGrow&&X(()=>{if(!k.value||!$.value)return;const s=getComputedStyle(k.value),x=getComputedStyle($.value.$el),h=parseFloat(s.getPropertyValue("--v-field-padding-top"))+parseFloat(s.getPropertyValue("--v-input-padding-top"))+parseFloat(s.getPropertyValue("--v-field-padding-bottom")),y=k.value.scrollHeight,A=parseFloat(s.lineHeight),K=Math.max(parseFloat(e.rows)*A+h,parseFloat(x.getPropertyValue("--v-input-control-height"))),Y=parseFloat(e.maxRows)*A+h||1/0,I=Be(y??0,K,Y);a.value=Math.floor((I-h)/A),z.value=Re(I)})}Ce(i),b(l,i),b(()=>e.rows,i),b(()=>e.maxRows,i),b(()=>e.density,i);let C;return b(k,s=>{s?(C=new ResizeObserver(i),C.observe(k.value)):C==null||C.disconnect()}),Ie(()=>{C==null||C.disconnect()}),Fe(()=>{const s=!!(r.counter||e.counter||e.counterValue),x=!!(s||r.details),[h,y]=Pe(g),{modelValue:A,...K}=ie.filterProps(e),Y=qe(e);return n(ie,Q({ref:c,modelValue:l.value,"onUpdate:modelValue":I=>l.value=I,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":o.value},e.class],style:e.style},h,K,{centerAffix:a.value===1&&!o.value,focused:u.value}),{...r,default:I=>{let{id:E,isDisabled:te,isDirty:ae,isReadonly:fe,isValid:he}=I;return n(Le,Q({ref:$,style:{"--v-textarea-control-height":z.value},onClick:j,onMousedown:T,"onClick:clear":H,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},Y,{id:E.value,active:L.value||ae.value,centerAffix:a.value===1&&!o.value,dirty:ae.value||e.dirty,disabled:te.value,focused:u.value,error:he.value===!1}),{...r,default:pe=>{let{props:{class:oe,...le}}=pe;return n(W,null,[e.prefix&&n("span",{class:"v-text-field__prefix"},[e.prefix]),se(n("textarea",Q({ref:S,class:oe,value:l.value,onInput:J,autofocus:e.autofocus,readonly:fe.value,disabled:te.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:M,onBlur:U},le,y),null),[[Se("intersect"),{handler:V},null,{once:!0}]]),e.autoGrow&&se(n("textarea",{class:[oe,"v-textarea__sizer"],id:`${le.id}-sizer`,"onUpdate:modelValue":ge=>l.value=ge,ref:k,readonly:!0,"aria-hidden":"true"},null),[[De,l.value]]),e.suffix&&n("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:x?I=>{var E;return n(W,null,[(E=r.details)==null?void 0:E.call(r,I),s&&n(W,null,[n("span",null,null),n(je,{active:e.persistentCounter||u.value,value:N.value,max:w.value},r.counter)])])}:void 0})}),Je({},c,$,S)}}),D=e=>(_e("data-v-58091bb0"),e=e(),ve(),e),Ht={class:"text_area"},At={class:"add_item"},Et={class:"add_item"},Gt={class:"add_item"},Ot={class:"add_item"},qt=D(()=>t("p",null," 损坏类型 ",-1)),Lt={class:"add_item"},jt=D(()=>t("p",null," 报修是否公开 ",-1)),Jt={class:"add_item"},Kt=D(()=>t("p",null," 是否被修复 ",-1)),Yt={class:"add_item"},Qt=D(()=>t("p",null," 报修详细信息 ",-1)),Wt={class:"add_item"},Xt=D(()=>t("p",null," 报修用户 ",-1)),Zt={class:"add_item"},ea=D(()=>t("p",null," 维修工 ",-1)),ta={__name:"SetOrderDialog",props:{order:{},orderModifiers:{},show:{},showModifiers:{}},emits:Ue(["update"],["update:order","update:show"]),setup(e,{emit:d}){const g=m([]),f=m(null),r=m(null),l=m(null),u=m(null),P=m([]),U=m([]),N=m([]),w=m(!1),V=m(!1),c=q(e,"order"),$=q(e,"show"),z=d;w.value=c.value.order_is_public==1,V.value=c.value.order_is_repaired==1;const S=async()=>{let a=await Ye();g.value=a.data.data},L=async()=>{let a=await ze();P.value=a.data.data,l.value=null,u.value=null},M=async()=>{let a=await Te(r.value);U.value=a.data.data,u.value=null},j=async()=>{let a=await He(l.value);N.value=a.data.data},T=m({}),H=async()=>{const a=await me(c.value.user_id);T.value=a.data.data},J=async()=>{let a={};a.order_is_public=w.value?1:0,a.order_is_repaired=V.value?1:0,a.final_location_id=u.value,a.damage_type_id=f.value,a.damage_details=c.value.damage_details,a.worker_id=c.value.worker_id,a.order_id=c.value.order_id,a.user_id=c.value.user_id,(await Qe(a)).data.code==1?(alert("修改成功"),$.value=!1,z("update")):alert("修改失败")},k=()=>{J()};return b(r,(a,o)=>{M(),l.value=null,u.value=null}),b(l,(a,o)=>{j(),u.value=null}),b(c,(a,o)=>{w.value=a.order_is_public==1,V.value=a.order_is_repaired==1,r.value=a.one_location_id,l.value=a.two_location_id,u.value=a.final_location_id,f.value=a.damage_type_id,H()}),H(),S(),L(),(a,o)=>(Z(),ce(ue,{modelValue:$.value,"onUpdate:modelValue":o[8]||(o[8]=i=>$.value=i),width:"800px"},{default:F(()=>[n(de,{"max-width":"700px",width:"80vw","prepend-icon":"ri-add",text:"",title:"修改订单"},{default:F(()=>[t("div",Ht,[t("div",At,[t("p",null," 一级地点 "+v(`上次选择->${c.value.one_location_name}`),1),t("div",null,[n(G,{modelValue:_(r),"onUpdate:modelValue":o[0]||(o[0]=i=>R(r)?r.value=i:null),items:_(P),"item-title":"one_location_name","item-value":"one_location_id"},null,8,["modelValue","items"])])]),t("div",Et,[t("p",null," 二级地点 "+v(`上次选择->${c.value.two_location_name}`),1),t("div",null,[n(G,{modelValue:_(l),"onUpdate:modelValue":o[1]||(o[1]=i=>R(l)?l.value=i:null),items:_(U),"item-title":"two_location_name","item-value":"two_location_id"},null,8,["modelValue","items"])])]),t("div",Gt,[t("p",null," 三级地点 "+v(`上次选择->${c.value.final_location_name}`),1),t("div",null,[n(G,{modelValue:_(u),"onUpdate:modelValue":o[2]||(o[2]=i=>R(u)?u.value=i:null),items:_(N),"item-title":"final_location_name","item-value":"final_location_id"},null,8,["modelValue","items"])])]),t("div",Ot,[qt,t("div",null,[n(G,{modelValue:_(f),"onUpdate:modelValue":o[3]||(o[3]=i=>R(f)?f.value=i:null),items:_(g),"item-title":"damage_type_name","item-value":"damage_type_id"},null,8,["modelValue","items"])])]),t("div",Lt,[jt,t("div",null,[n(Ae,{modelValue:_(w),"onUpdate:modelValue":o[4]||(o[4]=i=>R(w)?w.value=i:null),label:_(w)==1?"公开":"不公开"},null,8,["modelValue","label"])])]),t("div",Jt,[Kt,t("div",null,[n(re,{color:_(V)==1?"success":"error",onClick:o[5]||(o[5]=i=>V.value=_(V)==1?0:1)},{default:F(()=>[ee(v(_(V)==0?"未修复":"已修复"),1)]),_:1},8,["color"])])]),t("div",Yt,[Qt,t("div",null,[n(Tt,{variant:"outlined",name:"input-7-4",modelValue:c.value.damage_details,"onUpdate:modelValue":o[6]||(o[6]=i=>c.value.damage_details=i),label:"详细信息"},null,8,["modelValue"])])]),t("div",Wt,[Xt,t("div",null,v(`${_(T).user_name}(ID:${c.value.user_id})`),1)]),t("div",Zt,[ea,t("div",null,v(`(ID:${c.value.worker_id})`),1)]),n(Ne,{block:"",onClick:o[7]||(o[7]=i=>k())},{default:F(()=>[ee(" 提交订单 ")]),_:1})])]),_:1})]),_:1},8,["modelValue"]))}},ha=ne(ta,[["__scopeId","data-v-58091bb0"]]);export{ha as S,ma as d,fa as o,va as q,Qe as s};
